package com.atcdilivery.spring.jwt.mongodb.serviceImpl;

import com.atcdilivery.spring.jwt.mongodb.entity.OrderDetails;
import com.atcdilivery.spring.jwt.mongodb.payload.request.OrderDetailsReq;
import com.atcdilivery.spring.jwt.mongodb.payload.response.GetZoneResponse;
import com.atcdilivery.spring.jwt.mongodb.payload.response.Response;
import com.atcdilivery.spring.jwt.mongodb.repository.OrderDetailsRepository;
import com.atcdilivery.spring.jwt.mongodb.service.ApiService;
import com.atcdilivery.spring.jwt.mongodb.service.OrderService;
import com.atcdilivery.spring.jwt.mongodb.utilities.SequenceGenrator;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.ObjectUtils;

import java.util.Arrays;
import java.util.Date;
import java.util.List;

@Service
public class OrderServiceImpl implements OrderService {

    @Autowired
    OrderDetailsRepository orderRepository;

    @Autowired
    SequenceGenrator sequenceGenrator;

    @Autowired
    ApiService apiService;

    List<Integer> metroCityCodes = Arrays.asList(400001, 400002, 400003, 400004, 400005, 400006, 400007, 400008, 400009, 400010, 400011, 400012, 400013, 400014, 400015, 400016, 400017, 400018, 400019, 400020, 400021, 400022, 400023, 400024, 400025, 400026, 400027, 400028, 400029, 400030, 400031, 400032, 400033, 400034, 400035, 400036, 400037, 400038, 400039, 400040, 400041, 400042, 400043, 400044, 400045, 400046, 400047, 400048, 400049, 400050, 400051, 400052, 400053, 400054, 400055, 400056, 400057, 400058, 400059, 400060, 400061, 400062, 400063, 400064, 400065, 400066, 400067, 400068, 400069, 400070, 400071, 400072, 400073, 400074, 400075, 400076, 400077, 400078, 400079, 400080, 400081, 400082, 400083, 400084, 400085, 400086, 400087, 400088, 400089, 400090, 400091, 400092, 400093, 400094, 400095, 400096, 400097, 400098, 400099, 400101, 400102, 400103, 400104, 400105, 400106, 400107, 400108, 400109, 400110, 400111, 400112, 400113, 400114, 400115, 400116, 400117, 400118, 400119, 400120, 400121, 400122, 400123, 400601, 400602, 400603, 400604, 400605, 400606, 400607, 400608, 400610, 400612, 400614, 400615, 400701, 400702, 400703, 400706, 400708, 400709, 400710, 400711, 400712, 400713, 400614, 400715, 400801, 400802, 400803, 400804, 400805, 400806, 400807, 400808, 400809, 400810, 400812, 400613, 110001, 110002, 110003, 110004, 110005, 110006, 110007, 110008, 110009, 110010, 110011, 110012, 110013, 110014, 110015, 110016, 110017, 110018, 110019, 110020, 110021, 110022, 110023, 110024, 110025, 110026, 110027, 110028, 110029, 110030, 110031, 110032, 110033, 110034, 110035, 110036, 110037, 110038, 110039, 110040, 110041, 110042, 110043, 110044, 110045, 110046, 110047, 110048, 110049, 110050, 110051, 110052, 110053, 110054, 110055, 110056, 110057, 110058, 110059, 110060, 110061, 110062, 110063, 110064, 110065, 110066, 110067, 110068, 110069, 110070, 110071, 110072, 110073, 110074, 110075, 110076, 110077, 110078, 110079, 110080, 110081, 110082, 110083, 110084, 110085, 110086, 110087, 110088, 110089, 110090, 110091, 110092, 110093, 110094, 110095, 110096, 110097, 110098, 110099, 700046, 700027, 700027, 700020, 700027, 700027, 700014, 700044, 700086, 700022, 700019, 700019, 700019, 700014, 700007, 700008, 700018, 700034, 700034, 700010, 700054, 700025, 700066, 700032, 700042, 700012, 700088, 700034, 700027, 700073, 700017, 700054, 700007, 700073, 700001, 700001, 700141, 700031, 700013, 700029, 700107, 700016, 700069, 700021, 700047, 700019, 700024, 700075, 700047, 700019, 700046, 700020, 700095, 700019, 700069, 700078, 700082, 700022, 700072, 700088, 700069, 700033, 700014, 700078, 700032, 700061, 700034, 700017, 700068, 700010, 700024, 700085, 700020, 700082, 700031, 700053, 700063, 700026, 700099, 700026, 700089, 700054, 700042, 700061, 700026, 700001, 700023, 700053, 700073, 700001, 700020, 700045, 700029, 700001, 700025, 700014, 700071, 700016, 700060, 700023, 700141, 700071, 700027, 700013, 700099, 700053, 700047, 700011, 700027, 700040, 700053, 700087, 700001, 700024, 700034, 700094, 700017, 700016, 700060, 700009, 700063, 700041, 700032, 700054, 700072, 700026, 700001, 700018, 700001, 700047, 700023, 700009, 700044, 700054, 700025, 700029, 700092, 700040, 700001, 700040, 700071, 700094, 700026, 700038, 700015, 700012, 700075, 700075, 700029, 700061, 700015, 700014, 700034, 700017, 700041, 700043, 700072, 700043, 700026, 700007, 700010, 700033, 700024, 700014, 700015, 700088, 700088, 700001, 700063, 700073, 700033, 700001, 700075, 700001, 700062, 700023, 700001, 700012, 600018, 600020, 600082, 600029, 600040, 600102, 600101, 600002, 600106, 600083, 600023, 600090, 600108, 600021, 600113, 600020, 600018, 600032, 600001, 600005, 600031, 600002, 600112, 600094, 600106, 600012, 600032, 600025, 600003, 600003, 600008, 600032, 600018, 600025, 600118, 600008, 600084, 600028, 600009, 600082, 600014, 600021, 600086, 600002, 600001, 600006, 600032, 600015, 600104, 600017, 600038, 600036, 600020, 600083, 600014, 600082, 600078, 600013, 600020, 600024, 600010, 600010, 600024, 600118, 600021, 600012, 600085, 600107, 600092, 600005, 600033, 600014, 600034, 600001, 600002, 600003, 600005, 600005, 600033, 600004, 600001, 600033, 600079, 600001, 600004, 600035, 600107, 600010, 600034, 600034, 600034, 600006, 600030, 600003, 600005, 600011, 600012, 600012, 600011, 600018, 600014, 600002, 600012, 600084, 600028, 600082, 600022, 600028, 600024, 600013, 600003, 600014, 600004, 600013, 600118, 600015, 600015, 600015, 600093, 600004, 600011, 600001, 600006, 600020, 600030, 600079, 600092, 600012, 600018, 600018, 600006, 600020, 600017, 600017, 600017, 600113, 600005, 600041, 600041, 600081, 600081, 600081, 600014, 600113, 600026, 600042, 600012, 600007, 600092, 600004, 600039, 600039, 600021, 600021, 600031, 600033, 560063, 560030, 560034, 560007, 560007, 560092, 560024, 562106, 562106, 560045, 560003, 560050, 562107, 560064, 560047, 560026, 560086, 560002, 560070, 560064, 560073, 562149, 560053, 560050, 560085, 560043, 562149, 560017, 560001, 560002, 560002, 560009, 560002, 560025, 560001, 560083, 560076, 560026, 560004, 560002, 560079, 560086, 560103, 560046, 562106, 562157, 560010, 560049, 562107, 560049, 560056, 560068, 560001, 560026, 560093, 560025, 560064, 560002, 560018, 560018, 560040, 560053, 560097, 562157, 560061, 562130, 562130, 560001, 560050, 560026, 560067, 560045, 560036, 560029, 562149, 562157, 560062, 560037, 560071, 562125, 560016, 560001, 560100, 560005, 560065, 560019, 560019, 560021, 560085, 560022, 560026, 560026, 560013, 560087, 560013, 560024, 560008, 560051, 560102, 560104, 562125, 562106, 560024, 562106, 560001, 560068, 560048, 560043, 560085, 560030, 562106, 560076, 560008, 562157, 560094, 560066, 562106, 560038, 560038, 560010, 560085, 560078, 560006, 560064, 560013, 560014, 560013, 560015, 560043, 560041, 560070, 560069, 560011, 560005, 560066, 562106, 560078, 560079, 560009, 560020, 560084, 562130, 560067, 560067, 560043, 560015, 560079, 560067, 562149, 560096, 560085, 560098, 560034, 560064, 560092, 560062, 560034, 560034, 560095, 560077, 560036, 560016, 562125, 560078, 560074, 560037, 560004, 560001, 560084, 560054, 560011, 560068, 560023, 560048, 560086, 560001, 560033, 560056, 560003, 560055, 560033, 560037, 562106, 560033, 560054, 560004, 562107, 560049, 560067, 560076, 560055, 560076, 560054, 560049, 560025, 560099, 560087, 560017, 560067, 560072, 560073, 560045, 560096, 560019, 560002, 560001, 560039, 562107, 560002, 560075, 560021, 560032, 560070, 560003, 560087, 560004, 560058, 560058, 560058, 560032, 560094, 560010, 560010, 560010, 560064, 560098, 560001, 560021, 560066, 560045, 560016, 560037, 560025, 560059, 560080, 560092, 562106, 560067, 560027, 562125, 560012, 560020, 560004, 560027, 562106, 560064, 560042, 560008, 560002, 560021, 560034, 560084, 560050, 560009, 560061, 560003, 562157, 562130, 560029, 560049, 562106, 560041, 560006, 560028, 560056, 562106, 560087, 560052, 560003, 560045, 560001, 562157, 560097, 560040, 560040, 560078, 560017, 560049, 560004, 560091, 560018, 560047, 560003, 560064, 560066, 560027, 562107, 560070, 560078, 560064, 560064, 560037, 560022, 560022, 500030, 500004, 500045, 500007, 500012, 500015, 500044, 500013, 500004, 501201, 500015, 500044, 501301, 501301, 501301, 500030, 500040, 500020, 500048, 500015, 500058, 500064, 500005, 500034, 500027, 500004, 500012, 500016, 500003, 500018, 500080, 500039, 501301, 500013, 500022, 500024, 500064, 501301, 501301, 500005, 500081, 500015, 500008, 500024, 500028, 500006, 500060, 500062, 500062, 500018, 500053, 500065, 500018, 500029, 500015, 500001, 500080, 501301, 500015, 500008, 500020, 500015, 500068, 500062, 500052, 500066, 500029, 500025, 500001, 500051, 500035, 500028, 500064, 500016, 500016, 500008, 500002, 500013, 500001, 500048, 500076, 500082, 500007, 500031, 500040, 500015, 500007, 500015, 500079, 500085, 500033, 500008, 500058, 500079, 500006, 501301, 500077, 501301, 501301, 500005, 500004, 500062, 500003, 500064, 500030, 500015, 501301, 500067, 500015, 500015, 500062, 500074, 500063, 500015, 500017, 500017, 500008, 500003, 500081, 500036, 500076, 500005, 500006, 500068, 500001, 500002, 500018, 500040, 500015, 500028, 500020, 500020, 500044, 500008, 500062, 500029, 500026, 500060, 500063, 500044, 500007, 500027, 500015, 500036, 500029, 500012, 500036, 500060, 500025, 500004, 500005, 500004, 500015, 500039, 500003, 500015, 500016, 501301, 500095, 500065, 500069, 500045, 500071, 500041, 500016, 500030, 500035, 500029, 500095, 501301, 500074, 500015, 500023, 501301, 500024, 500059, 500059, 500017, 500008, 500018, 500018, 500038, 500059, 500035, 500003, 500001, 500013, 500065, 500028, 500052, 500004, 500061, 500076, 500082, 500033, 500073, 500013, 500036, 500001, 500095, 500027, 500065, 500015, 500039, 500052, 500018, 500064, 500002, 500007, 501301, 500015, 500008, 500080, 500039, 500053, 500070, 500079, 500070, 500038, 500004, 500044, 500057, 501101, 501301, 500023, 500045, 500020, 500013, 382120, 382220, 382460, 380001, 382250, 363610, 382255, 387810, 387810, 380006, 380015, 382463, 380026, 380007, 382115, 363610, 382250, 382230, 382150, 380016, 380024, 382140, 380009, 382427, 380015, 382465, 382276, 382255, 382230, 382460, 382170, 382430, 382240, 382145, 382145, 382240, 380024, 382425, 382450, 382455, 382220, 382220, 380022, 382450, 380060, 382140, 382463, 380028, 382455, 382140, 382210, 382433, 382220, 382150, 382230, 382145, 382230, 382430, 382330, 380054, 363610, 382170, 380058, 382150, 380022, 380004, 382260, 382255, 382433, 382260, 382481, 382150, 382213, 382450, 382110, 382120, 382433, 382115, 382220, 382140, 382170, 382460, 382220, 382250, 382145, 380016, 380026, 380019, 382120, 382120, 382110, 387810, 382130, 382220, 380001, 382150, 380008, 382220, 382120, 380004, 382240, 382120, 363610, 382140, 382213, 382150, 382435, 382465, 382460, 382220, 363610, 382130, 382230, 382455, 382240, 387810, 382470, 380001, 382170, 380004, 382150, 382230, 380006, 382130, 382110, 382465, 382210, 382465, 363610, 382120, 382435, 382465, 380027, 380001, 382240, 382265, 382115, 382449, 382435, 382140, 380061, 380001, 382150, 380050, 380058, 380004, 382425, 380022, 382255, 382115, 382463, 380021, 382150, 382110, 382463, 382481, 380060, 380009, 382255, 382230, 382120, 382460, 382405, 382150, 382435, 382445, 382455, 382435, 382150, 380024, 380015, 382170, 382265, 382443, 382470, 382230, 382150, 387810, 382150, 382255, 382120, 382460, 380001, 382110, 382449, 380008, 382230, 382250, 382426, 382170, 380051, 380015, 382150, 380055, 382150, 382220, 382220, 380005, 382463, 382130, 382170, 382470, 380001, 382240, 382465, 382150, 382430, 382110, 382433, 382150, 382140, 382150, 382210, 382430, 382430, 382145, 382265, 382260, 387810, 382220, 363610, 382240, 380001, 382460, 382450, 382450, 382460, 380001, 382460, 387810, 382255, 382460, 382170, 382421, 382350, 363610, 380008, 382170, 382150, 382455, 382220, 382140, 382150, 382210, 382240, 382460, 382345, 382430, 382340, 382340, 382433, 382430, 382120, 382150, 382110, 363610, 382130, 382110, 380008, 380001, 382405, 380060, 382330, 382465, 382230, 380022, 380004, 382145, 382425, 380051, 382110, 382130, 380001, 380008, 382150, 382110, 382120, 382213, 382330, 380016, 382150, 380052, 382455, 382425, 382230, 382220, 382213, 382460, 380005, 382110, 382230, 382145, 382255, 382425, 380001, 380002, 382345, 382120, 382330, 382130, 382435, 382230, 382220, 363610, 382220, 380013, 380007, 382330, 382330, 382345, 382330, 382405, 380013, 382130, 382210, 382450, 380014, 380009, 382130, 382115, 387810, 382350, 382481, 382340, 380005, 382427, 382120, 382415, 382150, 380060, 382463, 382463, 382460, 380007, 382425, 382140, 382465, 382455, 382250, 382330, 382430, 382110, 382465, 382425, 382265, 382250, 380015, 380004, 380016, 382150, 380001, 380019, 380002, 380001, 382220, 380021, 363610, 380023, 380023, 382130, 382449, 387810, 382140, 382220, 382150, 382480, 387810, 382433, 363610, 382220, 382460, 382255, 382110, 380002, 382130, 382230, 382450, 382460, 382120, 382220, 382240, 380015, 380008, 380005, 382150, 382120, 387810, 382405, 382345, 387810, 382220, 382451, 363610, 382110, 382210, 382455, 382463, 382120, 382220, 387810, 380018, 382475, 382230, 382220, 382210, 380007, 382260, 382150, 387810, 380028, 380004, 382150, 382405, 380007, 380013, 380058, 382130, 387810, 380058, 382140, 382230, 382170, 382140, 382265, 382120, 387810, 382130, 382145, 382463, 380060, 380013, 382130, 380013, 380004, 380023, 382255, 382145, 382350, 382250, 382210, 382145, 380059, 380054, 382150, 382150, 382150, 382425, 382470, 387810, 382150, 382120, 382140, 382150, 363610, 382250, 382433, 382110, 382230, 380013, 382150, 382450, 382433, 363610, 387810, 382450, 382463, 382449, 382150, 382130, 382150, 382150, 382130, 382265, 382425, 380008, 382460, 382170, 382213, 382418, 382265, 382440, 382445, 387810, 382330, 382230, 380051, 382110, 382120, 382110, 382445, 382130, 382150, 382265, 382170, 382210, 382120, 382430, 382460, 382120, 382150, 382250);

    List<Integer> zoneEListPinCodes = Arrays.asList(175032, 175001, 171302, 175121, 175034, 175028, 175032, 175035, 175027, 175035, 171302, 171304, 175033, 171304, 175038, 175033, 176121, 175033, 176120, 176126, 175106, 171302, 175052, 175008, 175121, 175124, 171304, 175029, 175024, 176122, 175001, 175033, 176122, 175030, 175021, 175036, 175052, 175042, 176126, 176120, 175034, 175005, 174403, 171302, 175006, 175049, 175004, 175021, 176120, 175003, 176120, 175002, 175047, 175001, 175050, 175001, 176122, 175024, 175027, 175031, 175028, 175045, 176120, 174401, 175047, 175032, 171304, 175048, 176120, 176090, 175037, 175033, 175031, 176121, 175027, 174401, 171303, 175027, 175042, 175025, 175036, 175003, 175030, 175124, 175029, 175004, 175106, 175040, 171302, 175040, 175034, 175027, 171302, 176120, 176120, 175001, 176123, 175001, 176120, 175024, 175006, 175049, 175008, 175032, 176121, 175049, 175023, 175032, 174401, 175106, 175124, 175026, 175025, 175031, 175040, 175029, 175032, 175007, 791111, 791112, 791123, 791123, 792104, 791112, 791113, 792104, 791121, 792104, 791111, 791112, 792104, 792104, 791121, 791123, 791119, 792104, 791112, 791110, 791110, 791109, 791001, 790001, 791113, 791112, 791123, 791113, 791113, 792104, 792104, 791110, 781128, 781137, 781102, 781137, 781127, 781025, 781023, 781026, 781031, 781014, 781027, 781134, 781003, 781006, 781003, 781017, 781127, 781366, 781127, 781102, 781381, 781380, 781124, 781124, 781381, 781103, 781141, 781021, 781364, 781354, 781134, 781101, 781030, 781354, 781366, 781382, 781104, 781135, 781354, 781121, 781364, 781380, 781136, 781029, 781137, 781122, 781028, 781366, 781121, 781132, 781123, 781009, 781017, 781136, 781102, 781137, 781366, 781364, 781121, 781365, 781381, 781122, 781018, 781123, 781123, 781123, 781123, 781026, 781135, 781015, 781103, 781124, 781120, 781124, 781102, 781104, 782402, 781124, 781136, 781150, 781150, 781101, 781380, 781354, 781366, 781003, 781124, 781141, 781031, 781104, 781380, 781133, 781122, 781135, 781102, 781376, 781011, 781122, 781012, 781136, 781101, 781354, 781364, 781014, 781125, 781354, 781025, 782403, 782401, 781382, 781005, 781380, 781030, 781101, 781121, 781123, 782403, 781001, 781122, 781135, 782403, 781103, 781035, 781102, 781124, 781123, 781354, 781016, 781366, 781125, 781011, 781366, 781015, 781014, 781102, 782402, 781129, 781102, 781121, 781103, 781038, 781137, 781127, 781382, 781036, 781380, 781039, 781032, 781137, 781013, 781141, 781127, 781365, 781382, 781005, 781122, 781134, 781136, 781354, 781127, 781019, 781124, 781380, 781127, 781136, 781102, 781127, 781010, 781380, 781381, 781366, 781121, 781022, 781102, 781004, 781380, 781102, 782403, 781127, 781382, 781123, 781134, 781104, 781125, 781009, 781102, 781007, 781381, 781120, 781129, 781354, 781030, 781366, 781364, 781137, 781136, 781128, 782403, 781136, 781136, 781121, 781127, 781125, 781354, 781120, 781123, 781125, 781011, 781127, 781132, 781127, 781129, 781102, 781026, 782402, 781124, 781364, 782403, 781104, 781020, 781030, 781034, 781104, 781135, 781124, 781136, 781127, 781128, 781008, 782401, 781012, 781012, 781123, 781026, 781137, 781101, 781037, 781171, 781127, 781127, 781381, 781354, 781101, 781380, 781120, 781102, 781364, 781132, 781122, 781365, 781354, 781131, 781124, 781008, 781030, 781104, 781032, 781012, 781121, 781129, 781141, 781122, 781027, 781132, 781034, 781040, 781124, 781125, 781103, 781366, 781003, 781122, 781135, 781135, 781135, 781103, 782402, 782402, 781382, 781102, 781103, 781364, 781381, 781354, 781364, 782402, 781104, 781365, 781354, 781102, 781102, 781137, 782403, 781137, 781376, 781127, 781171, 781354, 781124, 781007, 781122, 781001, 781102, 781024, 781350, 781129, 781131, 781131, 781029, 781129, 781131, 793001, 793106, 793107, 793004, 793111, 793108, 793112, 793106, 793005, 793012, 793112, 793106, 793007, 793112, 793002, 793110, 793002, 793015, 793112, 793015, 793106, 793021, 793022, 793004, 793111, 793111, 793010, 793010, 793108, 793110, 793111, 793003, 793110, 793113, 793004, 793121, 793015, 793121, 793021, 793108, 793106, 793121, 793110, 793108, 793113, 793113, 793016, 793111, 793012, 793009, 793121, 793015, 793017, 793015, 793015, 793015, 793108, 793121, 793012, 793121, 793121, 793106, 793121, 793008, 793021, 793113, 793022, 793001, 793106, 793110, 793009, 793022, 793018, 793110, 793015, 793110, 793009, 793011, 793121, 793014, 793005, 793001, 793021, 793113, 793113, 793008, 793010, 793121, 793021, 793106, 793110, 793111, 793121, 793004, 793015, 793113, 793006, 793112, 793001, 793015, 793108, 793121, 793108, 793121, 793015, 793106, 793104, 793113, 793106, 793015, 793113, 793015, 793106, 793113, 793012, 793111, 793108, 793121, 793006, 793110, 793015, 793015, 793109, 793005, 793109, 793108, 793110, 793121, 796190, 796261, 796001, 796007, 796161, 796014, 796007, 796471, 796581, 796261, 796007, 796005, 796012, 796007, 796261, 796009, 796161, 796005, 796017, 796261, 796111, 796001, 796009, 796025, 796007, 796009, 796190, 796161, 796471, 796005, 796161, 796471, 796261, 796005, 796017, 796017, 796161, 796005, 796261, 796111, 796017, 796161, 796005, 796190, 796410, 796009, 796261, 796014, 796007, 796261, 796111, 796471, 796261, 796005, 796190, 796111, 796005, 796009, 796471, 796005, 796005, 796261, 796005, 796014, 796007, 796261, 796007, 796261, 796005, 796111, 796111, 796111, 796007, 796111, 796261, 796017, 796261, 796261, 796190, 796012, 796007, 796009, 796111, 796005, 796261, 796005, 796005, 796261, 796190, 796111, 796261, 796111, 796009, 796190, 796190, 796017, 796014, 796161, 796007, 796017, 796230, 796261, 796036, 796261, 796190, 796190, 796009, 796005, 796161, 796190, 796005, 796111, 796161, 796007, 796015, 796161, 796261, 796007, 796111, 796009, 796261, 796111, 796471, 796014, 796471, 796261, 796017, 796111, 796017, 798607, 797115, 797099, 798603, 798613, 797105, 797104, 798614, 797103, 797117, 797112, 797112, 798615, 797021, 797110, 798611, 797001, 797002, 797003, 797004, 798616, 798625, 798627, 798604, 707106, 797114, 798621, 797119, 797113, 798622, 797113, 797004, 797101, 797107, 797108, 797120, 787118, 7986602, 797109, 798612, 798618, 798623, 797111, 798620, 737135, 737133, 737133, 737135, 737134, 737106, 737134, 737134, 737103, 737103, 737106, 737131, 737131, 737102, 737102, 737107, 737134, 737132, 737132, 737134, 737101, 737101, 737102, 737107, 737106, 737132, 737134, 737134, 737102, 737131, 737103, 737102, 737134, 737134, 737131, 737134, 737106, 737103, 737107, 737134, 737135, 737138, 737132, 737132, 737135, 737106, 737134, 737132, 737135, 737134, 737134, 737131, 737102, 737106, 737106, 737131, 737103, 737131, 737103, 737107, 737107, 737131, 737132, 737135, 737135, 737135, 737133, 737131, 737133, 737135, 737134, 737107, 737102, 737135, 737134, 737102, 737133, 737101, 737134, 737134, 737134, 737131, 737133, 737134, 737102, 737134, 737103, 737133, 737134, 737106, 737134, 737132, 737133, 737133, 737135, 737132, 737134, 737134, 799005, 799201, 799001, 799009, 799004, 799014, 799003, 799201, 799205, 799201, 799207, 799201, 799203, 799205, 799201, 799201, 799207, 799015, 799045, 799102, 799103, 799106, 799205, 799205, 799201, 799207, 799207, 799203, 799007, 799203, 799203, 799201, 799201, 799201, 799203, 799205, 799207, 799205, 799100, 799205, 799010, 799205, 799203, 799203, 799210, 799205, 799201, 799132, 799205, 799008, 799201, 799202, 799201, 799006, 799205, 799205, 799115, 799211, 799203, 799205, 799205, 799205, 799207, 799201, 799201, 799203, 799203, 799201, 799203, 799207, 799207, 799203, 799002, 799035, 799201, 799203, 799205, 799012, 799201, 799130, 799212, 799213, 799201, 799181, 799207, 799201, 799203, 799205, 799055, 799205, 799207, 799203);
//    Contains J&K ,Manipur ,Andaman Nikobar
    List<Integer> zoneFListPincodes = Arrays.asList(193502,193123,193502,193503,193222,193222,193201,193122,193101,193121,193101,193502,193224,193503,193501,193504,193222,193302,193101,193103,193301,193222,193223,193501,193502,193225,193224,193121,193122,193302,193503,193301,193504,193202,193202,193221,193501,193202,193221,193303,193108,193502,193503,193121,193301,193221,193224,193222,193121,193123,193222,193202,193101,193101,193223,193222,193502,193302,193201,193121,193201,193503,193122,193221,193123,193121,193501,193122,193504,193123,193224,193222,193221,193224,193222,193121,193221,193201,193221,193103,193301,193223,193502,193501,193501,193103,193303,193302,193221,193504,193502,193301,193301,193502,193223,193103,193122,193121,193302,193101,193223,193224,193121,193123,193121,193121,193502,193201,193501,193503,193224,193201,193502,193121,193302,193224,193303,193201,193225,193201,193101,193123,193108,193103,193202,193223,193121,193122,193225,193501,193123,193122,193302,193301,193121,193123,193101,193225,193108,193201,193223,193201,193108,193201,193201,193503,193224,193502,193501,193303,193201,193502,193303,193201,193101,193501,193301,193202,193222,193222,193121,193302,193122,193101,193502,193502,193503,193122,193502,193501,193101,193504,193504,193103,193225,193224,193223,193221,193503,193302,193224,193502,193303,193503,193101,193202,193225,193223,193223,193222,193223,193503,193201,193122,193224,193123,193103,193108,193302,193123,193121,193501,193224,193108,193223,193224,193101,193221,193502,193503,193502,193122,193301,193123,193201,193223,193122,193502,193302,193121,193303,193201,193224,193502,193221,193503,193224,193502,193224,193201,193101,193121,193224,193202,193121,193301,193222,193501,193222,193303,193302,193222,193221,193201,193101,193121,193225,193224,181202,181204,181133,181206,181224,184143,184144,181141,184144,181203,184121,184206,184205,181203,180011,184203,181206,180003,184121,184104,180003,184142,180007,180007,184121,181145,184152,184203,181224,181132,184102,184203,184205,181206,184205,184202,181221,181141,184201,181143,184104,181111,184121,184202,180005,184205,181133,180020,180016,181121,180017,181201,184148,184201,181152,184203,184104,185154,181202,184144,181101,181201,180010,180002,184121,184142,184148,180001,184102,181224,184148,181206,181101,181224,181122,184152,184144,180003,184201,184144,184205,184141,181132,181221,181207,181206,184205,181122,181111,184121,184121,180001,181102,180003,180002,180016,180006,181201,184206,184143,184203,181202,181101,184204,181102,184144,184203,180004,180016,181102,184206,184102,184152,184104,184141,181203,184121,181131,181221,181201,184101,184151,181131,184151,184120,181101,180017,181201,181205,181203,180001,180001,181204,184143,180005,180012,181131,184203,180011,180009,184141,180018,184151,181102,181123,181133,184152,184201,180002,181122,181203,184148,184206,185154,181202,181206,181102,184201,181206,184205,184142,185154,181201,184144,181221,181102,180001,181132,184202,181141,180005,180016,180001,184206,184203,184148,184204,184121,180001,180001,181102,184148,181122,184144,181101,184206,184121,180011,184152,184205,180004,184120,181201,181132,184202,184206,184143,181132,184145,184144,184205,184206,184206,181206,181206,181207,181201,180004,184142,184201,181202,184152,181101,181102,181201,184121,184121,184104,184121,180006,181203,184121,184201,184201,181145,184143,181101,184201,180005,180013,184206,181131,184141,184201,184120,184141,180017,184120,181141,180002,181201,181122,184203,184201,184144,181111,181224,181202,184204,184141,181111,181143,181203,181221,184120,180001,180005,184144,181132,184204,184203,184104,181202,184204,181145,184102,181206,181141,180003,181132,184102,184151,184144,180006,184120,184141,181143,184145,181141,184151,181203,180001,184142,181102,180002,181224,181131,184121,181121,184205,184121,181133,181132,181201,181202,184120,181132,181102,181102,184206,181132,184202,184203,184201,184143,184204,184102,181122,181206,181224,184148,181203,184102,184104,184204,181111,184152,184204,184121,181203,180006,181201,181131,181131,181102,181123,185154,184201,184121,181133,180019,181201,184204,184205,181145,181131,181102,181131,184144,181131,184204,184204,180017,180001,184143,181124,181206,180015,184144,180011,181132,180001,184102,185154,184143,181122,184120,184201,184143,181201,180010,181206,180017,184206,181203,181204,181201,184202,180003,184202,181101,180012,181121,184203,184203,181102,181122,181132,180002,181122,181102,181221,181133,184204,184152,194102,194201,194106,194109,194301,194101,194109,194401,194105,194109,194103,194401,194401,194105,194101,194106,194201,194106,194103,194201,194102,194401,194101,194109,194102,194102,194301,194301,194301,194301,194105,194401,194106,194201,194103,194301,194301,194106,194102,194103,194101,194106,194101,194101,194103,194201,194106,194109,194201,194201,194404,194302,194401,194301,194103,194103,194201,194402,194103,194201,194109,194103,194109,194105,194106,194201,194401,194401,194106,194103,194109,194101,194104,194101,194201,194302,194101,194104,194109,194106,194103,194302,194103,194106,194201,194106,194301,194105,194301,194106,194106,194101,194101,194103,194109,194105,194301,194102,194103,194105,194101,194101,194101,194201,194103,194106,194101,194101,194403,194301,194109,185212,185152,185101,185121,185202,185102,185132,185211,185131,185201,185211,185201,185101,185101,185101,185132,185101,185152,185135,185202,185211,185132,185155,185153,185201,185156,185131,185152,185131,185101,185211,185121,185152,185121,185121,185121,185132,185156,185211,185132,185132,185121,185211,185153,185101,185121,185102,185132,185233,185151,185151,185152,185155,185211,185151,185131,185201,185151,185131,185131,185151,185121,185202,185201,185155,185202,185102,185151,185212,185202,185132,185101,185202,185233,185132,185211,185212,185132,185202,185211,185151,185201,185155,185152,185121,185102,185202,185151,185121,185102,185151,185101,185152,185152,185101,185121,185233,185233,185135,185135,185156,185211,185102,185151,185131,185121,185131,185155,185233,185101,185102,185131,185151,185132,185211,185153,185212,185121,185202,185212,185151,185234,185132,185151,185102,185153,185152,185151,185151,185211,185151,185132,185121,185211,185155,185102,185233,185132,185151,185151,185201,185151,185131,185132,185212,185233,185121,185132,185102,185211,185233,185212,185121,185212,185201,185201,185233,185102,185131,185101,185156,185135,185155,185132,185233,185201,185211,185101,185132,185151,185212,185121,185233,185201,185131,185151,185156,185132,185211,185132,185152,185132,185155,185121,185132,185211,185131,185211,185202,185151,185211,185211,185233,185101,185121,185156,190003,192202,192233,193303,192231,190019,191113,190009,192303,190004,192212,192305,192231,193401,191112,193411,192233,193303,192302,193402,192231,191201,191113,192211,192231,193402,190002,192302,193401,190015,192101,190003,192233,192301,192211,190011,190001,191103,192301,192401,192231,190009,190017,192126,190017,192212,193401,192301,190001,190002,190001,191131,191111,192221,192221,191102,190006,191112,192201,193401,192232,190020,193411,193411,192231,192124,192122,191111,192231,191131,193401,192201,192123,191202,192231,192301,192401,193303,192202,192221,192211,191103,193303,192101,192125,193303,192301,190015,192121,191101,192221,192124,191113,191132,192231,192129,192124,192301,193402,192201,191131,192303,191113,192305,191113,193411,191202,192231,192122,190011,192123,192122,191101,191111,192123,192302,191113,191113,192201,192122,192233,193303,192232,192305,193411,190008,192231,190010,191131,190003,191112,192121,192303,191202,193404,192301,193411,192202,191111,192122,192221,193411,191112,191101,192123,193411,192302,191111,192303,190005,192230,193411,192202,192401,192124,192202,192305,192232,192124,191111,192231,192123,190018,190018,192123,192201,192101,191111,192101,192221,192123,192202,191112,192201,192231,192125,193303,193411,191202,192201,192401,192123,193411,193401,191112,192231,192125,190019,192401,191113,191101,192123,192221,192101,192221,191113,193303,192303,192201,192212,192231,191131,192221,193411,191113,192401,192121,192202,192201,191203,192101,192305,191113,192101,192221,191202,190012,191103,191111,192401,190009,191113,192230,193303,190001,193411,192401,192233,192210,192211,193401,192211,192212,191113,191111,192301,192304,192212,192231,192126,192212,192301,192124,192231,192202,190003,192125,193401,192233,193303,190015,192121,190011,192202,192231,192201,193401,192124,192232,190002,193411,193401,192123,192401,190001,192301,192232,192123,192305,192101,192101,191111,190024,190015,192201,192101,190001,192123,192301,190017,192124,192221,192202,192221,192201,192201,192101,192202,192211,192122,193403,190021,193402,192302,191113,192125,192101,191111,192124,192232,192202,192232,192121,193401,192123,192123,192202,192233,192221,192126,192301,190003,192302,192306,191202,192212,191113,192303,192123,192101,192302,190007,191111,192303,193401,192303,192124,192212,192231,192301,193401,191113,191101,192305,192302,193303,192302,192124,192302,192123,193401,192232,192123,192231,191113,192124,193401,193401,192401,192232,192233,193402,192123,192303,192121,191111,193401,191111,192401,192233,193303,191111,190023,192232,192231,192233,192303,192124,192202,193401,192233,192232,191111,192124,193401,192123,193411,192125,192121,191131,191131,192231,192201,192202,192401,192221,192303,192305,192233,192125,193402,193401,192122,191121,192232,192231,192122,193402,192123,190002,191202,193401,191112,192303,192211,190014,190006,193411,191103,192124,192305,193401,193401,191202,192125,193401,192301,192303,193303,190001,190015,192211,192231,192121,192301,192303,192301,192101,190008,190009,192303,192124,191111,192303,190025,192124,192302,192124,192124,192124,182301,182205,182122,182141,182146,182203,182122,182202,182144,185203,182144,182203,185203,182141,182122,182311,182121,182202,182201,182121,182124,182201,182146,182301,182222,182101,182142,182146,182121,182161,182125,182122,182148,182203,182101,182311,182201,182201,182101,182122,182313,182101,185203,182143,182202,182315,182126,182145,182311,182202,182126,182101,182201,182122,182101,182203,182148,182313,182124,185203,182125,182201,182301,182201,182205,182141,182301,182122,182145,182128,182144,182146,182143,182143,182101,182101,182221,185203,182124,182121,182205,182144,182301,185203,182201,182203,182146,182204,182121,182205,182203,182203,182125,182315,182145,182201,182201,182146,182205,182128,182204,182122,185203,182313,182121,182121,182101,182205,182311,182122,182311,182205,182202,182315,182122,182126,182311,185203,182121,182141,182222,182201,182221,182221,182205,182122,182122,182203,185203,182122,182148,182124,185203,182201,182313,182203,182204,182201,182204,182146,182122,182125,182101,182125,182148,182144,182312,182315,182201,182144,182203,182143,182221,182301,182204,182161,182146,182202,182202,182128,182206,182128,182121,182313,182202,182125,182144,182147,182145,182145,182141,182221,182125,182201,182147,182122,182141,182101,182313,182143,182127,182313,182311,182301,182128,182148,182141,182205,182203,182144,182202,182124,182147,182101,182147,182124,182312,182128,182128,182122,182204,182315,182142,182144,182221,182121,182201,182205,182145,182127,182201,182144,185203,182141,182143,182142,182204,182141,182201,182320,182141,182205,182313,182311,182313,182311,182143,182124,182315,182143,182127,182148,182313,182148,182222,182313,182313,182312,182315,182145,182122,182128,182126,182204,185203,182201,182127,182148,182204,182141,182311,182313,182313,182320,182204,185203,182146,182104,182126,182222,182145,182313,182201,182145,182122,182122,182146,182141,182125,185203,182315,182144,182204,182125,182144,182144,182204,182202,182144,182203,182121,182320,182142,182311,182201,182101,182125,182126,182127,182128,182203,182146,182313,182145,182122,182101,182143,185203,182148,182124,182313,182311,185203,182121,182148,795134,795126,795133,795133,795134,795124,795126,795126,795133,795133,795133,795126,795133,795134,795134,795134,795124,795134,795134,795133,795134,795134,795133,795126,795133,795126,795133,795133,795126,795133,795133,795126,795134,795134,795124,795134,795124,795134,795134,795124,795133,795133,795133,795134,795134,795133,795126,795133,795126,795126,795126,795133,795134,795133,795126,795126,795134,795124,795133,795133,795133,795133,795133,795126,795134,795134,795126,795133,795124,795133,795126,795133,795133,795134,795133,795133,795126,795102,795102,795131,795131,795102,795127,795131,795127,795131,795102,795102,795102,795131,795127,795127,795131,795127,795131,795102,795131,795131,795135,795102,795102,795102,795102,795101,795131,795131,795131,795102,795102,795131,795102,795143,795128,795139,795143,795128,795143,795128,795158,795128,795128,795128,795128,795143,795128,795139,795139,795128,795143,795128,795117,795128,795128,795128,795128,795139,795143,795143,795128,795139,795128,795128,795139,795143,795128,795117,795128,795139,795128,795128,795143,795128,795143,795128,795143,795143,795128,795128,795117,795118,795128,795128,795143,795143,795139,795128,795139,795143,795139,795139,795128,795143,795128,795128,795128,795143,795128,795143,795143,795128,795128,795143,795117,795117,795128,795117,795128,795128,795139,795005,795010,795114,795114,795010,795010,795008,795114,795010,795008,795008,795008,795008,795114,795114,795005,795008,795008,795008,795008,795010,795008,795010,795010,795116,795114,795003,795114,795005,795010,795008,795010,795010,795010,795008,795010,795114,795005,795114,795114,795114,795010,795136,795008,795005,795010,795010,795114,795140,795008,795114,795114,795114,795010,795114,795002,795132,795136,795002,795132,795115,795009,795116,795116,795115,795003,795004,795136,795132,795116,795116,795132,795146,795113,795001,795115,795113,795009,795132,795146,795002,795009,795146,795001,795001,795146,795004,795009,795132,795132,795116,795116,795146,795146,795146,795136,795002,795146,795115,795115,795116,795113,795113,795132,795002,795001,795113,795146,795002,795009,795132,795002,795113,795003,795003,795140,795146,795116,795004,795146,795004,795146,795113,795004,795003,795132,795002,795113,795116,795132,795002,795136,795132,795136,795113,795002,795132,795146,795003,795132,795113,795115,795113,795113,795116,795003,795004,795146,795009,795116,795113,795116,795146,795132,795146,795136,795004,795113,795009,795140,795132,795004,795132,795132,795132,795001,795116,795116,795113,795113,795002,795004,795132,795113,795116,795132,795132,795009,795140,795009,795113,795118,795112,795122,795104,795112,795104,795118,795112,795118,795122,795129,795118,795112,795107,795118,795104,795122,795129,795129,795007,795122,795122,795015,795112,795104,795007,795015,795104,795104,795015,795118,795015,795118,795150,795129,795129,795015,795118,795107,795118,795107,795107,795007,795106,795118,795104,795122,795150,795104,795118,795015,795150,795150,795015,795007,795107,795107,795118,795107,795104,795106,795104,795112,795118,795104,795125,795129,795122,795112,795007,795007,795107,795129,795118,795122,795129,795106,795104,795007,795007,795118,795141,795125,795141,795159,795141,795141,795125,795159,795147,795141,795125,795159,795125,795125,795125,795141,795147,795125,795141,795141,795141,795159,795147,795125,795125,795125,795125,795141,795159,795125,795147,795159,795141,795159,795125,795141,795159,795147,795147,795159,795147,795147,795141,795125,795141,795141,795141,795159,795141,795141,795125,795141,795135,795149,795135,795149,795130,795103,795138,795138,795149,795135,795101,795130,795149,795138,795135,795135,795148,795103,795138,795149,795130,795149,795130,795148,795148,795103,795149,795149,795138,795101,795103,795101,795103,795103,795103,795135,795149,795149,795149,795148,795149,795138,795103,795101,795138,795135,795135,795138,795135,795149,795148,795149,795101,795135,795103,795135,795138,795138,795135,795130,795135,795135,795135,795103,795135,795103,795138,795130,795135,795101,795149,795149,795101,795135,795101,795103,795103,795132,795135,795138,795135,795149,795135,795149,795135,795103,795149,795130,795138,795103,795138,795149,795130,795148,795138,795148,795103,795138,795135,795148,795148,795101,795148,795148,795149,795101,795101,795135,795149,795135,795103,795148,795148,795135,795130,795138,795138,795138,795138,795138,795103,795148,795149,795130,795130,795103,795103,795138,795148,795103,795149,795149,795149,795145,795145,795142,795145,795142,795142,795142,795145,795144,795142,795142,795142,795144,795142,795142,795142,795142,795144,795145,795145,795145,795142,795142,795145,795145,795145,795145,795145,795142,795142,795144,795142,795142,795142,795142,795144,795142,795145,795142,795142,795142,795145,795145,795145,795142,795142,795145,795144,795142,795145,795142,795145,795144,795142,795142,795142,795142,795142,795145,194106,194105,194101,194106,194201,194101,194101,194101,194101,194104,194201,194401,194106,194101,194101,194201,194106,194201,194106,194201,194101,194401,194201,194201,194201,194106,194401,194401,194201,194106,194101,194106,194101,194101,194404,194101,194104,194106,194106,194101,194201,194401,194106,194201,194101,194402,194106,194201,194201,194101,194401,194106,194106,194401,194106,194401,744105,744103,744210,744202,744103,744210,744202,744103,744210,744202,744103,744209,744202,744103,744209,744202,744103,744207,744202);

    @Override
    public Response createOrder(OrderDetailsReq orderDetailsReq) {
        OrderDetails newOrder = new OrderDetails();
        Response response = new Response();

        if (!ObjectUtils.isEmpty(orderDetailsReq)) {
            newOrder.setPickupName(orderDetailsReq.getPickupName());
            newOrder.setPickupEmail(orderDetailsReq.getPickupEmail());
            newOrder.setPickupMobile(orderDetailsReq.getPickupMobile());
            newOrder.setPickupAlternative_mobile(orderDetailsReq.getPickupAlternative_mobile());
            newOrder.setPickupPincode(orderDetailsReq.getPickupPincode());
            newOrder.setPickupCity(orderDetailsReq.getPickupCity());
            newOrder.setPickupState(orderDetailsReq.getPickupState());
            newOrder.setPickupAddress(orderDetailsReq.getPickupAddress());
            newOrder.setPickupLandmark(orderDetailsReq.getPickupLandmark());
            newOrder.setWarehouseName(orderDetailsReq.getWarehouseName());
            newOrder.setSellerName(orderDetailsReq.getSellerName());

            if (orderDetailsReq.isSameReturnOrder() == false) {
                newOrder.setSameReturnOrder(false);
                newOrder.setReturnName(orderDetailsReq.getReturnName());
                newOrder.setReturnEmail(orderDetailsReq.getReturnEmail());
                newOrder.setReturnMobile(orderDetailsReq.getReturnMobile());
                newOrder.setReturnAlternative_mobile(orderDetailsReq.getReturnAlternative_mobile());
                newOrder.setReturnPincode(orderDetailsReq.getReturnPincode());
                newOrder.setReturnCity(orderDetailsReq.getReturnCity());
                newOrder.setReturnState(orderDetailsReq.getReturnState());
                newOrder.setReturnAddress(orderDetailsReq.getReturnAddress());
                newOrder.setReturnLandmark(orderDetailsReq.getReturnLandmark());
            }
            newOrder.setSameReturnOrder(true);
            newOrder.setDropName(orderDetailsReq.getDropName());
            newOrder.setDropEmail(orderDetailsReq.getDropEmail());
            newOrder.setDropMobile(orderDetailsReq.getDropMobile());
            newOrder.setDropAlternative_mobile(orderDetailsReq.getDropAlternative_mobile());
            newOrder.setDropPincode(orderDetailsReq.getDropPincode());
            newOrder.setDropCity(orderDetailsReq.getDropCity());
            newOrder.setDropState(orderDetailsReq.getDropState());
            newOrder.setDropAddress(orderDetailsReq.getDropAddress());
            newOrder.setDropLandmark(orderDetailsReq.getDropLandmark());

            newOrder.setProductName(orderDetailsReq.getProductName());
            newOrder.setProductCategory(orderDetailsReq.getProductCategory());
            newOrder.setProductQuantity(orderDetailsReq.getProductQuantity());
            newOrder.setProductPrice(orderDetailsReq.getProductPrice());
            newOrder.setPaymentMode(orderDetailsReq.getPaymentMode());
            newOrder.setTotalAmount(orderDetailsReq.getTotalAmount());

            newOrder.setActualWeight(orderDetailsReq.getActualWeight());
            newOrder.setVolumentricWeight(orderDetailsReq.getVolumentricWeight());

            newOrder.setFragile(orderDetailsReq.getFragile());
            newOrder.setTotalTaxes(orderDetailsReq.getTotalTaxes());
            newOrder.setInvoiceDate(orderDetailsReq.getInvoiceDate());

            newOrder.setOrderId("ATCOD00" + sequenceGenrator.generateOrderSequence(newOrder.SEQUENCE_NAME));
            newOrder.setUserId(orderDetailsReq.getUserId());
            newOrder.setCreateDate(new Date());
            newOrder.setModifyDate(new Date());
            newOrder.setOrderLive(false);

            newOrder.setZone(getZone((int) orderDetailsReq.getPickupPincode(), (int) orderDetailsReq.getDropPincode()));

            OrderDetails savedOrder = orderRepository.save(newOrder);
            response.setStatusCode(200);
            response.setMessage("Order Saved Successfully " + newOrder.getOrderId());
            return response;
        }
        response.setStatusCode(409);
        response.setMessage("Some Details Might be Empty");
        return response;
    }

    @Override
    public String getZone(int originPincode, int destinationPincode) {
        String originCity = apiService.getCityByPincode(originPincode);
        String destinationCity = apiService.getCityByPincode(destinationPincode);
        Double distance = apiService.getDistance(originPincode, destinationPincode);

        if (originCity.equals(destinationCity)) {
//       Zone A Within Same City
            return "Zone A";
        } else if (metroCityCodes.contains(originPincode) && metroCityCodes.contains(destinationPincode)) {
//       Zone C Metro City both pin code has to be Metro
            return "Zone C";
        } else if (zoneEListPinCodes.contains(originPincode) || zoneEListPinCodes.contains(destinationPincode)) {
//       Zone E Special Zone
            return "Zone E";
        } else if (zoneFListPincodes.contains(originPincode) || zoneFListPincodes.contains(destinationPincode)) {
//       Zone F J&K Andaman and ALl
            return "Zone F";
        } else if (distance <= 500) {
//       Zone B
            return "Zone B";
        } else if (distance > 500 && distance < 2500) {
//       Zone D
            return "Zone D";
        }else if(distance > 2500){
            return "Distance Above 2500Km";
        }else {
            return "Pin code is Unserviceable";
        }
    }

    @Override
    public GetZoneResponse getZoneTest(int originPincode, int destinationPincode) {
        String originCity = apiService.getCityByPincode(originPincode);
        String destinationCity = apiService.getCityByPincode(destinationPincode);
        Double distance = apiService.getDistance(originPincode, destinationPincode);

        GetZoneResponse response = new GetZoneResponse();

        if (originCity.equals(destinationCity)) {
//       Zone A Within Same City
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone A");
            return response;
        } else if (metroCityCodes.contains(originPincode) && metroCityCodes.contains(destinationPincode)) {
//       Zone C Metro City both pin code has to be Metro
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone C");
            return response;
        } else if (zoneEListPinCodes.contains(originPincode) || zoneEListPinCodes.contains(destinationPincode)) {
//       Zone E Special Zone
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone E");
            return response;
        } else if (zoneFListPincodes.contains(originPincode) || zoneFListPincodes.contains(destinationPincode)) {
//       Zone F J&K Andaman and ALl
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone F");
            return response;
        } else if (distance <= 500) {
//       Zone B
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone B");
            return response;
        } else if (distance > 500 && distance < 2500) {
//       Zone D
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone D");
            return response;
        }else if(distance > 2500){
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Zone G");
            return response;
        }else {
            response.setOriginCity(originCity);
            response.setDestinationCity(destinationCity);
            response.setDistance(distance);
            response.setZone("Pin code is Unserviceable");
            return response;
        }
    }


    @Override
    public Response editOrder(OrderDetailsReq orderDetailsReq, String id) {
        OrderDetails existingOrder = orderRepository.findById(id).get();
        Response response = new Response();
        if (!ObjectUtils.isEmpty(existingOrder) && existingOrder.isOrderLive() == false) {
            existingOrder.setPickupName(orderDetailsReq.getPickupName());
            existingOrder.setPickupEmail(orderDetailsReq.getPickupEmail());
            existingOrder.setPickupMobile(orderDetailsReq.getPickupMobile());
            existingOrder.setPickupAlternative_mobile(orderDetailsReq.getPickupAlternative_mobile());
            existingOrder.setPickupPincode(orderDetailsReq.getPickupPincode());
            existingOrder.setPickupCity(orderDetailsReq.getPickupCity());
            existingOrder.setPickupState(orderDetailsReq.getPickupState());
            existingOrder.setPickupAddress(orderDetailsReq.getPickupAddress());
            existingOrder.setPickupLandmark(orderDetailsReq.getPickupLandmark());

            if (orderDetailsReq.isSameReturnOrder() == false) {
                existingOrder.setReturnName(orderDetailsReq.getReturnName());
                existingOrder.setReturnEmail(orderDetailsReq.getReturnEmail());
                existingOrder.setReturnMobile(orderDetailsReq.getReturnMobile());
                existingOrder.setReturnAlternative_mobile(orderDetailsReq.getReturnAlternative_mobile());
                existingOrder.setReturnPincode(orderDetailsReq.getReturnPincode());
                existingOrder.setReturnCity(orderDetailsReq.getReturnCity());
                existingOrder.setReturnState(orderDetailsReq.getReturnState());
                existingOrder.setReturnAddress(orderDetailsReq.getReturnAddress());
                existingOrder.setReturnLandmark(orderDetailsReq.getReturnLandmark());
            }

            existingOrder.setDropName(orderDetailsReq.getDropName());
            existingOrder.setDropEmail(orderDetailsReq.getDropEmail());
            existingOrder.setDropMobile(orderDetailsReq.getDropMobile());
            existingOrder.setDropAlternative_mobile(orderDetailsReq.getDropAlternative_mobile());
            existingOrder.setDropPincode(orderDetailsReq.getDropPincode());
            existingOrder.setDropCity(orderDetailsReq.getDropCity());
            existingOrder.setDropState(orderDetailsReq.getDropState());
            existingOrder.setDropAddress(orderDetailsReq.getDropAddress());
            existingOrder.setDropLandmark(orderDetailsReq.getDropLandmark());

            existingOrder.setProductName(orderDetailsReq.getProductName());
            existingOrder.setProductCategory(orderDetailsReq.getProductCategory());
            existingOrder.setProductQuantity(orderDetailsReq.getProductQuantity());
            existingOrder.setProductPrice(orderDetailsReq.getProductPrice());
            existingOrder.setPaymentMode(orderDetailsReq.getPaymentMode());
            existingOrder.setTotalAmount(orderDetailsReq.getTotalAmount());
            existingOrder.setActualWeight(orderDetailsReq.getActualWeight());
            existingOrder.setVolumentricWeight(orderDetailsReq.getVolumentricWeight());

            existingOrder.setFragile(orderDetailsReq.getFragile());
            existingOrder.setTotalTaxes(orderDetailsReq.getTotalTaxes());
            existingOrder.setInvoiceDate(orderDetailsReq.getInvoiceDate());

            existingOrder.setModifyDate(new Date());
            orderRepository.save(existingOrder);

            response.setStatusCode(200);
            response.setMessage("Order Edited Successfully " + existingOrder.getOrderId());
            return response;
        } else {
            response.setStatusCode(409);
            response.setMessage("Order Doesn't exist");
            return response;
        }
    }

    @Override
    public List<OrderDetails> getManifestOrders(String userId) {
        return orderRepository.findAllByUserIdAndOrderLiveFalse(userId);
    }

    @Override
    public List<OrderDetails> getMyOrders(String userId) {
        return orderRepository.findAllByUserIdAndOrderLiveTrue(userId);
    }
}
